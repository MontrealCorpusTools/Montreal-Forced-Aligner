.. _`Arabic acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/arabic.zip

.. _`Bulgarian acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/bulgarian.zip

.. _`Croatian acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/croatian.zip

.. _`Czech acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/czech.zip

.. _`English acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/english.zip

.. _`French (FR) acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/french.zip

.. _`French (Prosodylab) acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/french_prosodylab.zip

.. _`French (QC) acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/french_qc.zip

.. _`German acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/german.zip

.. _`German (Prosodylab) acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/german_prosodylab.zip

.. _`Hausa acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/hausa.zip

.. _`Japanese acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/japanese.zip

.. _`Korean acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/korean.zip

.. _`Mandarin acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/mandarin.zip

.. _`Polish acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/polish.zip

.. _`Portuguese acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/portuguese.zip

.. _`Russian acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/russian.zip

.. _`Spanish acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/spanish.zip

.. _`Swahili acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/swahili.zip

.. _`Swedish acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/swedish.zip

.. _`Tamil acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/tamil.zip

.. _`Thai acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/thai.zip

.. _`Turkish acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/turkish.zip

.. _`Ukrainian acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/ukrainian.zip

.. _`Vietnamese acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/vietnamese.zip

.. _`Vietnamese (vPhon) acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/vietnamese_vphon.zip

.. _`Wu acoustic model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/acoustic/wu.zip


.. _`Pynini`: https://github.com/kylebgormon/Pynini
.. _`Sigmorphon 2020 G2P task baseline`: https://github.com/sigmorphon/2020/tree/master/task1/baselines/fst


.. _`Arabic G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/arabic_g2p.zip

.. _`Bulgarian G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/bulgarian_g2p.zip

.. _`Croatian G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/croatian_g2p.zip

.. _`Czech G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/czech_g2p.zip

.. _`English G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/english_g2p.zip

.. _`French G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/french_g2p.zip

.. _`French (Lexique) G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/french_lexique_g2p.zip

.. _`French (ProsodyLab) G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/french_prosodylab_g2p.zip

.. _`German G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/german_g2p.zip

.. _`German (ProsodyLab) G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/german_prosodylab_g2p.zip

.. _`Hausa G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/hausa_g2p.zip

.. _`Japanese G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/japanese_character_g2p.zip

.. _`Korean Hangul G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/korean_hangul_g2p.zip

.. _`Korean Jamo G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/korean_jamo_g2p.zip

.. _`Mandarin Pinyin G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/mandarin_pinyin_g2p.zip

.. _`Mandarin Character G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/mandarin_character_g2p.zip

.. _`Polish G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/polish_g2p.zip

.. _`Portuguese G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/portuguese_g2p.zip

.. _`Russian G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/russian_g2p.zip

.. _`Spanish G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/spanish_g2p.zip

.. _`Swahili G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/swahili_g2p.zip

.. _`Swedish G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/swedish_g2p.zip

.. _`Thai G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/thai_g2p.zip

.. _`Turkish G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/turkish_g2p.zip

.. _`Ukrainian G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/ukrainian_g2p.zip

.. _`Vietnamese G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/vietnamese_g2p.zip

.. _`Vietnamese (vPhon) G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/vietnamese_vphon_g2p.zip

.. _`Wu G2P model`: https://github.com/MontrealCorpusTools/mfa-models/raw/main/g2p/wu_g2p.zip

.. _`ProsodyLab dictionary repository`: https://github.com/prosodylab/prosodylab.dictionaries

.. _`Lexique`: http://www.lexique.org/

.. _`ProsodyLab French dictionary`: https://github.com/prosodylab/prosodylab.dictionaries/raw/master/fr.dict

.. _`English pronunciation dictionary`:  https://raw.githubusercontent.com/MontrealCorpusTools/mfa-models/main/dictionary/english.dict
.. _`French Prosodylab dictionary`:  https://raw.githubusercontent.com/MontrealCorpusTools/mfa-models/main/dictionary/fr.dict
.. _`German Prosodylab dictionary`:  https://raw.githubusercontent.com/MontrealCorpusTools/mfa-models/main/dictionary/de.dict
.. _`TalnUPF Spanish IPA dictionary`:  https://raw.githubusercontent.com/TalnUPF/phonetic_lexica/master/es/es_lexicon-IPA.txt
.. _`TalnUPF Spanish gpA dictionary`:  https://raw.githubusercontent.com/TalnUPF/phonetic_lexica/master/es/es_lexicon-gpA.txt
.. _`TalnUPF Catalan IPA dictionary`:  https://raw.githubusercontent.com/TalnUPF/phonetic_lexica/master/ca/ca_lexicon-IPA.txt

.. _`GlobalPhone language models`: https://www.csl.uni-bremen.de/GlobalPhone/

.. _`LibriSpeech language models`: https://www.openslr.org/11/

.. _`FalaBrasil language models`: https://gitlab.com/fb-asr/fb-asr-resources/kaldi-resources/-/tree/main/lm
.. _`FalaBrasil dictionary`: https://gitlab.com/fb-nlp/nlp-resources/-/tree/main/res

.. _pretrained_models:

*****************
Pretrained models
*****************

The command for interacting with MFA models is :code:`mfa model`.  The subcommands allow for inspecting currently saved pretrained models, downloading ones from MFA's model repo, and saving models you have trained to be used with a simple name rather than the full path each time.

Following installation of MFA, :code:`mfa model list acoustic` will not list any models.  If you want to download the default English model trained on Librispeech, you can run :code:`mfa model download acoustic english`.  At which point, the previous ``list`` command will output "english" as an option.  When referring to an acoustic model in another MFA command, rather than the full path to the acoustic model, you can now supply just ``english`` and MFA will resolve it to the saved path.

Similarly, if you train a new model, you can run :code:`mfa model save acoustic /path/where/the/model/was/saved.zip`, then this model will be available via ``saved`` in the future.  The name defaults to whatever the archive is called without the directory or extension.  You can modify this name with the ``--name NEWNAME`` option

There are a number of pretrained models for aligning and generating pronunciation dictionaries. The command
for downloading these is :code:`mfa download <model_type>` where ``model_type`` is one of ``acoustic``, ``g2p``, or
``dictionary``.

.. _pretrained_acoustic:

Pretrained acoustic models
==========================

As part of using the Montreal Forced Aligner in our own research, we have trained acoustic models for a number of languages.
If you would like to use them, please download them below.  Please note the dictionary that they were trained with to
see more information about the phone set.  When using these with a pronunciation dictionary, the phone sets must be
compatible.  If the orthography of the language is transparent, it is likely that we have a G2P model that can be used
to generate the necessary pronunciation dictionary.

Any of the following acoustic models can be downloaded with the command :code:`mfa download acoustic <language_id>`.  You
can get a full list of the currently available acoustic models via :code:`mfa download acoustic`.  New models contributed
by users will be periodically added. If you would like to contribute your trained models, please contact Michael McAuliffe
at michael.e.mcauliffe@gmail.com.

.. csv-table::
   :header: "Language", "Link", "Corpus", "Number of speakers", "Audio (hours)", "Phone set"

   "Arabic", `Arabic acoustic model`_, "GlobalPhone", 80, 19.0, "GlobalPhone"
   "Bulgarian", `Bulgarian acoustic model`_, "GlobalPhone", 79, 21.4, "GlobalPhone"
   "Croatian", `Croatian acoustic model`_, "GlobalPhone", 94, 15.9, "GlobalPhone"
   "Czech", `Czech acoustic model`_, "GlobalPhone", 102, 31.7, "GlobalPhone"
   "English", `English acoustic model`_, "LibriSpeech", 2484, 982.3, "Arpabet (stressed)"
   "French (FR)", `French (FR) acoustic model`_, "GlobalPhone", 100, 26.9, "GlobalPhone"
   "French (FR)", `French (Prosodylab) acoustic model`_, "GlobalPhone", 100, 26.9, "Prosodylab [1]_"
   "French (QC)", `French (QC) acoustic model`_, "Lab speech", "N/A", "N/A", "Prosodylab [1]_"
   "German", `German acoustic model`_, "GlobalPhone", 77, 18, "GlobalPhone"
   "German", `German (Prosodylab) acoustic model`_, "GlobalPhone", 77, 18, "Prosodylab [3]_"
   "Hausa", `Hausa acoustic model`_, "GlobalPhone", 103, 8.7, "GlobalPhone"
   "Japanese", "Not available yet", "GlobalPhone", 144, 34, "GlobalPhone"
   "Korean", `Korean acoustic model`_, "GlobalPhone", 101, 20.8, "GlobalPhone"
   "Mandarin", `Mandarin acoustic model`_, "GlobalPhone", 132, 31.2, "Pinyin phones [6]_"
   "Polish", `Polish acoustic model`_, "GlobalPhone", 99, 24.6, "GlobalPhone"
   "Portuguese", `Portuguese acoustic model`_, "GlobalPhone", 101, 26.3, "GlobalPhone"
   "Russian", `Russian acoustic model`_, "GlobalPhone", 115, 26.5, "GlobalPhone"
   "Spanish", `Spanish acoustic model`_, "GlobalPhone", 102, 22.1, "GlobalPhone"
   "Swahili", `Swahili acoustic model`_, "GlobalPhone", 70, 11.1, "GlobalPhone"
   "Swedish", `Swedish acoustic model`_, "GlobalPhone", 98, 21.7, "GlobalPhone"
   "Tamil", "Not available yet", "GlobalPhone", "N/A", "N/A", "GlobalPhone"
   "Thai", `Thai acoustic model`_, "GlobalPhone", 98, 28.2, "GlobalPhone"
   "Turkish", `Turkish acoustic model`_, "GlobalPhone", 100, 17.1, "GlobalPhone"
   "Ukrainian", `Ukrainian acoustic model`_, "GlobalPhone", 119, 14.1, "GlobalPhone"
   "Vietnamese", `Vietnamese acoustic model`_, "GlobalPhone", 129, 19.7, "GlobalPhone"
   "Wu", "Not available yet", "GlobalPhone", 41, 9.3, "GlobalPhone"

.. _pretrained_g2p:

Pretrained G2P models
=====================


Included with MFA is a separate tool to generate a dictionary from a preexisting model. This should be used if you're
aligning a dataset for which you have no pronunciation dictionary or the orthography is very transparent. We have pretrained
models for several languages below.

Any of the following G2P models can be downloaded with the command :code:`mfa download g2p <language_id>`.  You
can get a full list of the currently available G2P models via :code:`mfa download g2p`.  New models contributed
by users will be periodically added. If you would like to contribute your trained models, please contact Michael McAuliffe
at michael.e.mcauliffe@gmail.com.

These models were generated using the `Pynini`_ package on the GlobalPhone dataset. The implementation is based on that in the
`Sigmorphon 2020 G2P task baseline`_.
This means that they will only work for transcriptions which use the same
alphabet. Current language options are listed below, with the following accuracies when trained on 90% of the data and
tested on 10%:

.. csv-table::
   :header: "Language", "Link", "WER", "LER", "Orthography system", "Phone set"

   "Arabic", `Arabic G2P model`_, 28.45, 7.42, "Romanized [2]_", "GlobalPhone"
   "Bulgarian", `Bulgarian G2P model`_, 3.08, 0.38, "Cyrillic alphabet", "GlobalPhone"
   "Croatian", `Croatian G2P model`_, 9.47, 3.4, "Latin alphabet", "GlobalPhone"
   "Czech", `Czech G2P model`_, 3.43, 0.71, "Latin alphabet", "GlobalPhone"
   "English", `English G2P model`_, 28.45, 7.42, "Latin alphabet", "Arpabet"
   "French", `French G2P model`_, 42.54, 6.98, "Latin alphabet", "GlobalPhone"
   "French", `French (Lexique) G2P model`_, 5.31, 1.06, "Latin alphabet", "Lexique"
   "French", `French (Prosodylab) G2P model`_ [1]_, 5.11, 0.95, "Latin alphabet", "Prosodylab"
   "German", `German G2P model`_, 36.16, 7.84, "Latin alphabet", "GlobalPhone"
   "German", `German (Prosodylab) G2P model`_ [3]_, 5.43, 0.65, "Latin alphabet", "Prosodylab"
   "Hausa", `Hausa G2P model`_, 32.54, 7.19, "Latin alphabet", "GlobalPhone"
   "Japanese", `Japanese G2P model`_, 17.45, 7.17, "Kanji and kana", "GlobalPhone"
   "Korean", `Korean Hangul G2P model`_, 11.85, 1.38, "Hangul", "GlobalPhone"
   "Korean", `Korean Jamo G2P model`_, 8.94, 0.95, "Jamo", "GlobalPhone"
   "Mandarin", `Mandarin Pinyin G2P model`_, 0.27, 0.06, "Pinyin", "Pinyin phones"
   "Mandarin", `Mandarin Character G2P model`_ [4]_, 23.81, 11.2, "Hanzi", "Pinyin phones [6]_"
   "Polish", `Polish G2P model`_, 1.23, 0.33, "Latin alphabet", "GlobalPhone"
   "Portuguese", `Portuguese G2P model`_, 10.67, 1.62, "Latin alphabet", "GlobalPhone"
   "Russian", `Russian G2P model`_, 4.04, 0.65, "Cyrillic alphabet", "GlobalPhone"
   "Spanish", `Spanish G2P model`_, 17.93, 3.02, "Latin alphabet", "GlobalPhone"
   "Swahili", `Swahili G2P model`_, 0.09, 0.02, "Latin alphabet", "GlobalPhone"
   "Swedish", `Swedish G2P model`_, 18.75, 3.14, "Latin alphabet", "GlobalPhone"
   "Thai", `Thai G2P model`_, 27.62, 7.48, "Thai script", "GlobalPhone"
   "Turkish", `Turkish G2P model`_, 8.51, 2.32, "Latin alphabet", "GlobalPhone"
   "Ukrainian", `Ukrainian G2P model`_, 2.1, 0.42, "Cyrillic alphabet", "GlobalPhone"
   "Vietnamese", `Vietnamese G2P model`_, 14.91, 3.46, "Vietnamese alphabet", "GlobalPhone"
   "Wu", `Wu G2P model`_ [5]_ , 31.19, 13.04, "Hanzi", "GlobalPhone"


.. [1] The `ProsodyLab French dictionary`_ is based on `Lexique`_ with substitutions for numbers and special characters.
   Note that Lexique is known to currently not work with the aligner, see the `Github issue <https://github.com/MontrealCorpusTools/Montreal-Forced-Aligner/issues/29>`_
   for more information and status.
.. [2] Please see the GlobalPhone documentation for how the romanization was done for Arabic.
.. [3] The German dictionary used in training is available in the `ProsodyLab dictionary repository`_.
   See http://www.let.uu.nl/~Hugo.Quene/personal/phonchar.html for more information on the CELEX phone set for German
   and how it maps to other phonesets.
.. [4] The Mandarin character dictionary that served as the training data for this model was built by mapping between
   characters in ``.trl`` files and pinyin syllables in ``.rmn`` files in the GlobalPhone corpus.
.. [5] The Wu G2P model was trained a fairly small lexicon, so it likely does not have the coverage to be a robust model
   for most purposes.  Please check carefully any resulting dictionaries, as they are likely to have missing syllables from
   from unknown symbols.
.. [6] The phoneset for Mandarin was created by GlobalPhone by splitting Pinyin into onset, nucleus (any vowel sequence),
   and codas, and then associating the tone of the syllable onto the nucleus (i.e. "fang2" -> "f a2 ng" and "xiao4" ->
   "x iao4"

.. _dictionaries:

Available pronunciation dictionaries
====================================

Any of the following pronunciation dictionaries can be downloaded with the command :code:`mfa download dictionary <language_id>`.  You
can get a full list of the currently available dictionaries via :code:`mfa download dictionary`.  New dictionaries contributed
by users will be periodically added. If you would like to contribute your dictionaries, please contact Michael McAuliffe
at michael.e.mcauliffe@gmail.com.

.. csv-table::
   :header: "Language", "Link", "Orthography system", "Phone set"

   "English", `English pronunciation dictionary`_ , "Latin", "Arpabet (stressed)"
   "French", `French Prosodylab dictionary`_, "Latin", "Prosodylab French"
   "German", `German Prosodylab dictionary`_, "Latin", "Prosodylab German"
   "Brazilian Portuguese", `FalaBrasil dictionary`_, "Latin", ""
   "Spanish", `TalnUPF Spanish IPA dictionary`_, "Latin", "IPA"
   "Spanish", `TalnUPF Spanish gpA dictionary`_, "Latin", "gpA"
   "Catalan", `TalnUPF Catalan IPA dictionary`_, "Latin", "IPA"

.. _language_models:

Available language models
=========================

There are several places that contain pretrained language models that can be imported to MFA.

.. csv-table::
   :header: "Source", "Language", "Link"

   "GlobalPhone", "Various languages", `GlobalPhone language models`_
   "LibriSpeech", "English", `LibriSpeech language models`_
   "FalaBrasil", "Brazilian Portuguese", `FalaBrasil language models`_
